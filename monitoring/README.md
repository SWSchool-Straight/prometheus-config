# 모니터링 알림 규칙 문서

이 문서는 Kubernetes 클러스터의 모니터링 알림 규칙에 대한 설명을 제공합니다.

## 목차
- [ArgoCD 알림](#argocd-알림)
- [Chatbot 서비스 알림](#chatbot-서비스-알림)
- [Auth 서비스 알림](#auth-서비스-알림)
- [PostgreSQL 알림](#postgresql-알림)

## ArgoCD 알림

### ArgocdApplicationHealth
- **심각도**: Critical
- **발생 조건**: 
  - 애플리케이션의 Health 상태가 "Healthy"가 아님
  - Health는 정상이지만 Sync 상태가 "Synced"가 아님
- **확인 사항**:
  - Git 저장소와 실제 배포된 상태의 차이
  - 애플리케이션의 Health 상태 저하 원인
  - 배포 과정에서의 오류 로그

### ArgoAppNotSynced
- **심각도**: Warning
- **발생 조건**: 12시간 이상 동기화되지 않은 상태 지속
- **중요성**: 장기간 동기화되지 않은 상태는 의도적이거나 문제가 있을 수 있음
- **확인 사항**:
  - Git 저장소의 변경사항
  - ArgoCD UI에서의 동기화 실패 원인
  - 의도적인 동기화 중단인지 여부

### ArgocdServerDown
- **심각도**: Critical
- **발생 조건**: ArgoCD 서버 접근 불가
- **중요성**: CI/CD 파이프라인 전체에 영향
- **확인 사항**:
  - ArgoCD 서버 파드 상태
  - 로그 확인
  - 네트워크 연결성

### ArgocdApplicationControllerDown
- **심각도**: Critical
- **발생 조건**: 애플리케이션 컨트롤러 접근 불가
- **중요성**: 애플리케이션 동기화 및 상태 관리 불가
- **확인 사항**:
  - 컨트롤러 파드 상태
  - 시스템 리소스 사용량
  - 로그 확인

### ArgoAppRollback
- **심각도**: Warning
- **발생 조건**: 동기화 실패로 인한 롤백 발생
- **중요성**: 배포 실패 추적
- **확인 사항**:
  - 롤백 원인 분석
  - 실패한 배포의 변경사항
  - 애플리케이션 로그

## Chatbot 서비스 알림

### ChatbotPodDown
- **심각도**: Critical
- **발생 조건**: 파드가 Failed/Unknown 상태이거나 Running 상태가 아님
- **중요성**: 서비스 중단 상황
- **확인 사항**:
  - 파드 이벤트 로그
  - 컨테이너 로그
  - 노드 상태

### ChatbotHighMemoryUsage
- **심각도**: Warning
- **발생 조건**: 메모리 사용량 85% 초과
- **중요성**: 성능 저하 및 OOM 킬 위험
- **확인 사항**:
  - 메모리 사용량 추이
  - 메모리 누수 가능성
  - 리소스 제한 적절성

### ChatbotHighCPUUsage
- **심각도**: Warning
- **발생 조건**: CPU 사용량 80% 초과
- **중요성**: 성능 저하 가능성
- **확인 사항**:
  - CPU 사용량 패턴
  - 비정상적인 프로세스
  - 스케일링 필요성

### ChatbotRestartFrequent
- **심각도**: Warning
- **발생 조건**: 1시간 내 2회 이상 재시작
- **중요성**: 애플리케이션 안정성 문제
- **확인 사항**:
  - 재시작 원인
  - 크래시 로그
  - 메모리/CPU 사용량

## Auth 서비스 알림

### AuthPodDown
- **심각도**: Critical
- **발생 조건**: 파드가 Failed/Unknown 상태이거나 Running 상태가 아님
- **중요성**: 인증 서비스 중단으로 전체 시스템에 영향
- **확인 사항**:
  - 파드 상태 및 이벤트
  - 시스템 로그
  - 의존성 서비스 상태

### AuthHighMemoryUsage
- **심각도**: Warning
- **발생 조건**: 메모리 사용량 85% 초과
- **중요성**: 인증 서비스 성능 저하
- **확인 사항**:
  - 메모리 사용량 패턴
  - 동시 접속자 수
  - 캐시 상태

### AuthHighCPUUsage
- **심각도**: Warning
- **발생 조건**: CPU 사용량 80% 초과
- **중요성**: 인증 처리 지연 가능성
- **확인 사항**:
  - CPU 사용량 추이
  - 요청 처리량
  - 성능 병목 지점

### AuthRestartFrequent
- **심각도**: Warning
- **발생 조건**: 1시간 내 2회 이상 재시작
- **중요성**: 인증 서비스 안정성 문제
- **확인 사항**:
  - 재시작 패턴
  - 에러 로그
  - 구성 오류

## PostgreSQL 알림

### PostgreSQLHighConnections
- **심각도**: Warning
- **발생 조건**: 사용 가능한 연결 수가 20개 미만
- **중요성**: 데이터베이스 연결 가용성 문제
- **확인 사항**:
  - 현재 활성 연결 상태
  - 오래된 연결 존재 여부
  - 커넥션 풀 설정의 적절성

### PostgreSQLDiskSpaceLow
- **심각도**: Warning
- **발생 조건**: 디스크 사용량 85% 초과
- **중요성**: 데이터베이스 저장 공간 부족 위험
- **확인 사항**:
  - 데이터베이스별 용량 사용량
  - 대용량 테이블 식별
  - VACUUM 필요성 검토
  - 디스크 확장 계획

### PostgreSQLHighWALGeneration
- **심각도**: Warning
- **발생 조건**: WAL 생성 속도가 10MB/s 초과
- **중요성**: 데이터베이스 성능 및 복구 시간에 영향
- **확인 사항**:
  - WAL 설정 상태
  - 트랜잭션 패턴 분석
  - 대량 갱신 작업 식별
  - WAL 아카이빙 상태

## 알림 심각도 수준

- **Critical**: 즉각적인 조치가 필요한 심각한 문제
- **Warning**: 주의가 필요하지만 즉각적인 서비스 영향은 없는 문제

## 일반적인 문제 해결 단계

1. 알림 내용 확인
   - 알림의 정확한 원인과 영향 범위 파악
   - 관련된 메트릭 데이터 검토

2. 로그 분석
   - 관련 서비스의 로그 확인
   - 시스템 이벤트 로그 검토

3. 리소스 모니터링
   - CPU, 메모리, 디스크 사용량 확인
   - 네트워크 상태 점검

4. 조치 및 기록
   - 문제 해결을 위한 적절한 조치 수행
   - 조치 내용과 결과 문서화 